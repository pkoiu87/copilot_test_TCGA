import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\n\n# DEGs 데이터 로드\ndeg_data = pd.read_csv('deg_data.csv')  # DEGs 데이터는 CSV 형식으로 가정\n\n# BRCA 아형에 따라 색상 설정\n# 각 아형에 대한 색상 정의 (예: Luminal A, Luminal B, Basal, HER2)\ncolors = {\n    'Luminal A': '#1f77b4',\n    'Luminal B': '#ff7f0e',\n    'Basal': '#2ca02c',\n    'HER2': '#d62728'\n}  \n\n# DEG 행렬 준비 시트\n
# DEG 아형 설정\nlabels = deg_data['subtype'].unique()  # 아형 목록 가져오기\ndeg_matrix = deg_data.pivot(index='gene', columns='subtype', values='expression')\n\n# 히트맵 작성\nplt.figure(figsize=(10, 8))\nsns.heatmap(deg_matrix, cmap='coolwarm', annot=True, fmt='.2f', center=0, linewidths=.5)\n\n# 아형 레이블 비행\nplt.title('DEG Heatmap by BRCA Subtypes')\nplt.xlabel('BRCA Subtypes')\nplt.ylabel('Genes')\nplt.xticks(rotation=45)\n\n# 한국어 주석 추가\nplt.subplots_adjust(bottom=0.2)\nplt.savefig('brca_deg_heatmap.png')  # 이미지 저장\nplt.show()\n